<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liverpool Fan Shop - Checkout</title>
    <link id="favicon" rel="icon" href="Liverpool-FC-80s-icon.png" type="image/png">
    <link rel="stylesheet" href="styles.css">
    <!-- Google Tag Manager Should Go Here -->
    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '935724062207149');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=935724062207149&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
</head>

<body>
    <!-- Google Tag Manager (noscript) should go here-->
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="products.html">Products</a></li>
                <li><a href="cart.html">Cart (<span id="cart-count">0</span>)</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h1>Checkout</h1>

        <div class="checkout-container">
            <div class="form-section">
                <form id="checkout-form">
                    <label for="name">Name:</label>
                    <input type="text" id="name" value="John Doe">

                    <label for="email">Email:</label>
                    <input type="email" id="email" value="johndoe@example.com">

                    <label for="address">Address:</label>
                    <input type="text" id="address" value="123 Main St">

                    <label for="city">City:</label>
                    <input type="text" id="city" value="Anytown">

                    <label for="state">State:</label>
                    <input type="text" id="state" value="CA">

                    <label for="zip">Zip:</label>
                    <input type="text" id="zip" value="12345">

                    <button id="purchase-btn" type="button" onclick="completePurchase()">Complete Purchase</button>
                </form>
            </div>

            <div class="cart-summary-section">
                <h2>Order Summary:</h2>
                <table id="cart-summary-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="cart-summary-body"></tbody>
                </table>
                <p>Total: $<span id="cart-total">0</span></p>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
    <!-- Meta Pixel InitiateCheckout Event -->
    <script>
    (function() {
        var cartData = JSON.parse(localStorage.getItem('cart') || '{}');
        var contentIds = Object.keys(cartData).map(function(name) { return name.toLowerCase().replace(/ /g, '-'); });
        var contents = Object.keys(cartData).map(function(name) {
            return {id: name.toLowerCase().replace(/ /g, '-'), quantity: cartData[name].quantity};
        });
        var numItems = Object.values(cartData).reduce(function(acc, item) { return acc + item.quantity; }, 0);
        var value = Object.values(cartData).reduce(function(acc, item) { return acc + (item.price * item.quantity); }, 0);
        fbq('init', '935724062207149');
        fbq('track', 'InitiateCheckout', {
            content_ids: contentIds,
            contents: contents,
            currency: 'USD',
            num_items: numItems,
            value: value
        });
    })();
    </script>
    <!-- End Meta Pixel InitiateCheckout Event -->
</body>
</html>
